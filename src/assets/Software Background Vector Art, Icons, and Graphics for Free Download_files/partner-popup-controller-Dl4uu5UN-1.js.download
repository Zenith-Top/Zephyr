import{a as h}from"./stimulus-helpers-Bg5ApOVk-1.js";import c from"./ez-base-controller-DuL8VR07-1.js";import{a as n}from"./js-Cz0CWeBA-1.js";import{C as a,F as l,l as m,G as g,N as f,O as P,H as d}from"./helpers-SiW2vY12-1.js";import{o,c as S,s as u}from"./partner-popup-helpers-D9kg_dU1-1.js";import{sendTrackingEvent as _}from"./tracking-wc8XaWQf-1.js";import{aV as T}from"./actions-DEzMaOTc-1.js";import"./stimulus-Cq41p_up-1.js";import"./init-user-BlDnuGFC-1.js";import"./ez-popunder-CPI-tcnF-1.js";const w=2,t=class t extends c{maybePagination(e){if(this.mode="pagination",!this.shouldShowPopup())return;const r=this.getNavigationPage(e.target);if(a("partner_alt_popup_triggers")){const p=n.get("partner_popup_pagination")||0,i=parseInt(p,10)+1;if(n.set("partner_popup_pagination",`${i}`,{expires:l()}),i<w)return}this.hasSearchValues&&_({data:{action:T,label:`Terms-${this.termsValue}`,value:r,partner_popup_origin:this.sourceValue}}),o(this.partnerUrl())}getNavigationPage(e){if(!e||!this.hasCurrentPageTarget)return this.pageValue;if(e===this.currentPageTarget){const r=parseInt(m(this.currentPageTarget),10);return r>this.totalPagesValue?this.totalPagesValue:r}return this.pageValue}maybeSearch(e=null){a("partner_alt_popup_triggers")||g()||!this.shouldShowPopup()||this.isLucky()&&(this.searchForm=(e==null?void 0:e.currentTarget)||null,this.mode="search",o(this.partnerUrl()))}shouldShowPopup(){var e;return f()||!((e=window.partnerService)!=null&&e.showIndirect())?!1:a("partner_alt_popup_triggers")?S()&&!u():!u()}isLucky(){return this.randomNumber()===3}randomNumber(){return Math.floor(Math.random()*5)+1}get searchTerm(){const e=this.searchForm||document.querySelector("[data-controller~='search-form']");if(!e)return null;if(this.mode==="pagination")return e.getAttribute("data-search-term").replace(/-/g," ");const r=e.querySelector('input[name="search"]')||e.querySelector('input[name="search_fullwidth"]');return r?r.value:null}partnerUrl(){return window.partnerService.indirectUrl({placement:this.partnerPlacement(),searchTerm:this.searchTerm})}partnerPlacement(){if(this.mode==="pagination")return"pagination";const{classList:e}=document.body;return e.contains("home-home_vectors")?"SearchPopHome":P()?"SearchPopShow":d()?"SearchPopSearch":"SearchPopOther"}get hasSearchValues(){return this.hasTermsValue&&this.hasPageValue&&this.hasSourceValue}};t.targets=["currentPage"],t.values={terms:String,page:Number,totalPages:Number,source:String};let s=t;h({name:"partner-popup",import:s});export{s as default};
