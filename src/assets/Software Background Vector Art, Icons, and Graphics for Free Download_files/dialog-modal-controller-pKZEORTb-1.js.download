import{a as u}from"./stimulus-helpers-Bg5ApOVk-1.js";import{ezClearFormErrors as p}from"./error-helpers-DGFBXUyQ-1.js";import g from"./ez-base-controller-DuL8VR07-1.js";import{a as f}from"./button-helpers-CvZG-X-W-1.js";import{t as m}from"./helpers-SiW2vY12-1.js";import"./stimulus-Cq41p_up-1.js";import"./tracking-wc8XaWQf-1.js";import"./js-Cz0CWeBA-1.js";import"./actions-DEzMaOTc-1.js";import"./init-user-BlDnuGFC-1.js";const c=class c extends g{open(o=null,t=null){var s,i;o==null||o.preventDefault();const e=t||((s=o==null?void 0:o.params)==null?void 0:s.id)||((i=o==null?void 0:o.detail)==null?void 0:i.id);if(e){let r=document.getElementById(e);const a=document.getElementById("template-modal-container");if(!r){if(r=a.content.cloneNode(!0).querySelector(`#${e}`),!r)throw Error(`No such modal with id: ${e} exists!`);a.insertAdjacentElement("afterend",r)}this.closeAllOpenDialogs(),r.addEventListener("dialog:close",l=>{this.close(l)}),r.show(),m("dialog:open"),m("dialog:open",{},r)}}close(o,t=e=>{}){var l,d;const e=o.currentTarget.closest(".dialog-modal"),s=e.querySelector('[data-dialog-modal-target="content"]'),i=e.querySelector(".ez-modal__modal");if(e.hasAttribute("data-disable-easy-close")||o.target===i)return;const r=(l=o.target)==null?void 0:l.getAttribute("data-action"),a=r&&r.match(/#close(\s|$)/);(!s.contains(o.target)||s.contains(o.target)&&a||((d=o==null?void 0:o.detail)==null?void 0:d.closeSelf)===!0)&&(e.close(),this.postClosingActions(e),t&&t(o))}closeAllOpenDialogs(){[...document.querySelectorAll("dialog[open]"),...document.querySelectorAll(".ez-faux-modal")].forEach(t=>{t.classList.contains("dialog-modal")&&t.close(),this.postClosingActions(t)})}postClosingActions(o){o.removeEventListener("dialog:close",t=>{this.close(t)}),this.resetDialogForm(o),this.removeIfAjaxy(o)}resetDialogForm(o){const t=o.querySelector(".ez-btn.has-spinner");t&&f(t);const e=o.querySelector("form");e&&(e.reset(),this.resetFormOnDialogCloseValue&&(p(e),e.querySelectorAll('.ez-input input[required="required"], .ez-input select[required="required"]').forEach(r=>{r&&r.classList.remove("is-touched")})));const s=o.querySelectorAll(".ez-input__error-message");s&&s.forEach(i=>{i.parentNode.removeChild(i)})}removeIfAjaxy(o){var t;(t=o.getAttribute("data-controller"))!=null&&t.includes("ajax-dialog")&&o.parentNode.removeChild(o)}};c.values={resetFormOnDialogClose:{type:Boolean,default:!0}};let n=c;u({name:"dialog-modal",import:n});export{n as default};
